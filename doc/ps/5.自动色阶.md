# 自动色阶

自动色阶（Auto Levels）是一种图像调整算法，用于优化图像的对比度和色彩平衡。它通过动态地调整图像的黑点、
白点和中间灰色值来拉伸图像的整体色阶范围，使得图像的亮度分布更均匀，细节更加清晰。

下面是一个基本的自动色阶算法的示例：

- 计算图像中像素值的直方图，统计每个像素值的出现次数。

- 找到直方图中最小和最大的非零像素值，分别对应图像中的黑点和白点。

将图像的像素值映射到0到255的范围内，通过线性变换将黑点映射到0，白点映射到255。其他像素值按比例缩放。

可选步骤：进一步优化中间灰色值的对比度，可以使用曲线调整或者直方图均衡化等技术。

这个算法实现了自动调整图像的亮度范围，使得图像的黑色和白色区域充分利用了整个像素值范围，从而增强了图像的对比度和细节。

需要注意的是，自动色阶算法是一种基于统计分析的自动调整方法，它可能无法完全符合人类的主观感受。因此，在应用自动色阶算法时，可能需要根据具体需求进行适当的调整和微调，以获得满意的结果。此外，对于特定类型的图像，如高动态范围（HDR）图像或特殊色彩的图像，可能需要采用其他更复杂的算法进行调整。

// 着色器代码
uniform sampler2D inputTexture; // 输入图像纹理

void main()
{
vec4 color = texture2D(inputTexture, gl_TexCoord[0].xy);
float luminance = dot(color.rgb, vec3(0.299, 0.587, 0.114)); // 使用加权平均计算亮度
vec4 levels = vec4(0.0, 0.0, 0.0, 1.0); // 初始化黑点、白点和中间灰色值
levels.xy = texture2D(inputTexture, vec2(0.0, 0.5)).xz; // 获取直方图最小非零值，作为黑点
levels.zy = texture2D(inputTexture, vec2(1.0, 0.5)).xw; // 获取直方图最大非零值，作为白点
vec4 adjustedColor = (color - levels.xxxx) / (levels.yyyy - levels.xxxx); // 像素值映射到0-1范围
gl_FragColor = vec4(clamp(adjustedColor.rgb, 0.0, 1.0), 1.0); // 输出调整后的像素值
}

感觉看不到